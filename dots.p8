pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
function _init()
	play_init()
end

function play_init()
	ents={}
	
	pl0=ent_make({x=64,y=64,col=12})

	_update60=play_update
	_draw=play_draw
end

function play_update()
	local ix,iy=0,0
	if (btn(0,0)) ix-=1
	if (btn(1,0)) ix+=1
	if (btn(2,0)) iy-=1
	if (btn(3,0)) iy+=1
	
	local l=ix*ix+iy*iy
	if (l~=0) ix,iy=ix/l,iy/l
	
	pl0.dx=ix
	pl0.dy=iy
	
	if rnd()<0.1 then
		ent_make({
			x=rnd(128),y=rnd(128),
			life_t=rnd(2),
			col=7
		})
	end

	foreach(ents,
		function(e)
			e.x+=e.dx
			e.y+=e.dy
		end)
		
	foreach(ents,
		function(e)
			if e.life_t~=nil then
				e.life_t-=1/60
				if e.life_t<=0 then
					del(ents,e)
				end
			end
		end)
end

function play_draw()
	cls()
	foreach(ents,
		function(e)
			pset(e.x,e.y,e.col)
		end)
end

ent={
	x=0,y=0,
	dx=0,dy=0,
	col=7
}

function ent_make(p)
	return add(ents,
		setmetatable(
	
	{
		x=p.x or 0,
		y=p.y or 0,
		dx=0,dy=0,
		col=p.col or 7
	})
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

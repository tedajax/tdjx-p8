pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
function _init()
	gravity=0.02
--	gravity=0
	ldr={
		x=64,y=64,
		dx=0,dy=0,
		r=0,
		thrust=0,
	}
	
	turn_rate=1/60
	prec_turn_rate=1/180
	
	fire_fx={}

	_update=play_update
	_draw=play_draw
end

function play_update()
	foreach(fire_fx,
		function(f)
			f.⧗+=1	
			if f.lifetime>0 and f.⧗>=f.lifetime then
				del(fire_fx,f)
			end
			f.x+=f.dx
			f.y+=f.dy
			f.dx*=f.ix
			f.dy*=f.iy
		end)

	local ix=0
	if (btn(0)) ix-=1
	if (btn(1)) ix+=1
	
	local tr=turn_rate
	if (btn(❎)) tr=prec_turn_rate
	ldr.r+=ix*tr
	
	ldr.thrust=0
	if (btn(2)) ldr.thrust=1
	
	local fwd_x=-sin(ldr.r)
	local fwd_y=-cos(ldr.r)
	
	if ldr.thrust>0 then
	
		add_fire(ldr.x-fwd_x*4,ldr.y-fwd_y*3,
			ldr.dx-fwd_x*1,
			ldr.dy-fwd_y*1,
			6)
	end

	local thrust=ldr.thrust*0.1
	ldr.dx+=fwd_x*thrust
	ldr.dy+=fwd_y*thrust

	ldr.dy+=gravity
	ldr.x+=ldr.dx
	ldr.y+=ldr.dy
end

function play_draw()
	cls()
	
	map(0,0,0,0,16,16)

--	rottspr(ldr.x,ldr.y,ldr.r,126,62,2,false,1)
	rottspr(ldr.x,ldr.y,ldr.r,124,63,1,false,1)

	foreach(fire_fx,
		function(f)
			circ(f.x,f.y,1,8)
		end)

end

function add_fire(x,y,dx,dy,⧗,opt)
	local f={
		x=x or 0,y=y or 0,
		dx=dx or 0,dy=dy or 0,
		ix=ix or 1,iy=iy or 1,
		⧗=0,
		lifetime=⧗ or 0,
	}
	tblcpy(opt,f)
	return add(fire_fx,f)
end
-->8
function rottspr(x,y,rot,mx,my,w,flip,scale)
	scale=scale or 1
	w+=.8
	local halfw=scale*-w/2
	local cx=mx+w/2-.4
	local cs=cos(rot)/scale
	local ss=-sin(rot)/scale
	local cy=my-halfw/scale-.4
	local sx=cx+cs*halfw
	local sy=cy-ss*halfw
	local hx=w*(flip and -4 or 4)*scale
	local hy=w*4*scale
	
	rect(x-hx,y-hy,x+hx,y+hy,5)
	
	for py=y-hy,y+hy do
		tline(x-hx,py,x+hx,py,
			sx+ss*halfw,sy+cs*halfw,
			cs/8,-ss/8)
		halfw+=1/8
	end
end

function tblcpy(src,dst)
	dst=dst or {}
	for k,v in pairs(src) do
		dst[k]=v
	end
	return dst
end

__gfx__
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0000000000000000000000ddddddddd
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d5666666666666666666665ddddddddd
007007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d5555555555555555555555ddddddddd
000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddddddddddddddddddddddddddd
0007700000000000000000000000000000000000000000000000000000000000d0000000000000000000000d00000000dddddddddddddddddddddddddddddddd
0070070000000000000000000000000000000000000000000000000000000000d5666666666666666666665d00000000dddddddddddddddddddddddddddddddd
0000000000000000000000000000000000000000000000000000000000000000d5555555555555555555555d00000000dddddddddddddddddddddddddddddddd
0000000000000000000000000000000000000000000000000000000000000000dddddddddddddddddddddddd00000000dddddddddddddddddddddddddddddddd
00066000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ddd00000d000000000000
006cc6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0d00dd0d0ddddd000ddd0d000000000
006cc6000000000000000000000000000000000000000000000000000000000000000000000d00000000000000000000dddddddddddddddddddddddd00000000
0066660000000000000000000000000000000000000000000000000000000000000000000000d0000000000000000000dddddddddddddddddddddddd00000000
066666600000000000000000000000000000000000000000000000000000000000000000000ddd00000d000000000000dddddddddddddddddddddddd00000000
6666666600000000000000000000000000000000000000000000000000000000d0d00dd0d0ddddd000ddd0d000000000dddddddddddddddddddddddd00000000
6606606600000000000000000000000000000000000000000000000000000000dddddddddddddddddddddddd00000000dddddddddddddddddddddddd00000000
6000000600000000000000000000000000000000000000000000000000000000dddddddddddddddddddddddd00000000dddddddddddddddddddddddd00000000
0000000660000000000000000000000000000000000000000000000000000000d0000000dd000000000000000000000000000000000000000000000000000000
0000006666000000000000000000000000000000000000000000000000000000dd000000dddd0000000000000000000000000000000000000000000000000000
0000006cc6000000000000000000000000000000000000000000000000000000ddd00000dddddd00000000000000000000000000000000000000000000000000
0000066cc6600000000000000000000000000000000000000000000000000000dddd0000dddddddd000000000000000000000000000000000000000000000000
0000066cc6600000000000000000000000000000000000000000000000000000ddddd000dddddddddd0000000000000000000000000000000000000000000000
0000066666600000000000000000000000000000000000000000000000000000dddddd00dddddddddddd00000000000000000000000000000000000000000000
0000066666600000000000000000000000000000000000000000000000000000ddddddd0dddddddddddddd000000000000000000000000000000000000000000
0000666666660000000000000000000000000000000000000000000000000000dddddddddddddddddddddddd0000000000000000000000000000000000000000
00006666666600000000000000000000000000000000000000000000000000000000000d00000000000000dd0000000000000000000000000000000000000000
0006666666666000000000000000000000000000000000000000000000000000000000dd000000000000dddd0000000000000000000000000000000000000000
006666666666660000000000000000000000000000000000000000000000000000000ddd0000000000dddddd0000000000000000000000000000000000000000
00666666666666000000000000000000000000000000000000000000000000000000dddd00000000dddddddd0000000000000000000000000000000000000000
0666006666006660000000000000000000000000000000000000000000000000000ddddd000000dddddddddd0000000000000000000000000000000000000000
066000666600066000000000000000000000000000000000000000000000000000dddddd0000dddddddddddd0000000000000000000000000000000000000000
66600060060006660000000000000000000000000000000000000000000000000ddddddd00dddddddddddddd0000000000000000000000000000000000000000
6660000000000666000000000000000000000000000000000000000000000000dddddddddddddddddddddddd0000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000313
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000390c0e1a18000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1900380f0f0f0f0f292a1a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f1d0f0f0f0f0f0f0f0f0f0c0d0e3a2900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
